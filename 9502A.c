#pragma config(Sensor, dgtl2,  goalLiftPistons, sensorDigitalOut)
#pragma config(Motor,  port2,           frontLeft,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port3,           frontRight,    tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port4,           liftMotors,    tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port5,           turretMotors,  tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port6,           verticalClaw,  tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port7,           clawMotor,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port8,           backLeft,      tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port9,           backRight,     tmotorVex393_MC29, openLoop)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

// Only necessary once Team A gets an LCD
// #include "../Include/LCD2.0.h"
#include "../Include/9502A_autonomous_routines.h"

// -----------------------------------------------------------------
// -------------------- ROBOTC Competition Code --------------------
// -----------------------------------------------------------------

#pragma platform(VEX2)
#pragma competitionControl(Competition)]
#include "Vex_Competition_Includes.c"

// -----------------------------------------------------------------
// --------------------    Global  Variables    --------------------
// -----------------------------------------------------------------

//Current autonomous routine number
short routineNum;

int deadZone(int inputVal, int thresholdVal)
{
	if(fabs(inputVal) > thresholdVal)
	{
		return inputVal;
	}
	else
	{
		return 0;
	}
}

// -----------------------------------------------------------------
// --------------------   Pre-Autonomous Code   --------------------
// -----------------------------------------------------------------

void pre_auton()
{
  bStopTasksBetweenModes = true;

  // Manually set autonomous routine number
  // 0 = Do nothing
  // 1 = firstAutonomous
  routineNum = 1;

  // Only necessary once Team A gets an LCD
  // startTask(autonomousSelector);

  // Stop the pre-autonomous section of code (just to be sure!)
  return;
}

// -----------------------------------------------------------------
// --------------------     Autonomous Code     --------------------
// -----------------------------------------------------------------

task autonomous()
{
	switch(routineNum)
	{
		case 0:
		{
			//Do nothing
			break;
		}
		case 1:
		{
			firstAutonomous();
			break;
		}
		case 2:
		{
			//SecondAutonomousFunction();
			break;
		}
		default:
		{
			break;
		}
	}
	return;
}

// -----------------------------------------------------------------
// --------------------   Driver Control Code   --------------------
// -----------------------------------------------------------------

task usercontrol()
{
	int x = 0;
	int y = 0;
	int r = 0;

	while(true)
	{
		//----------------------
		// Primary Controller
		//----------------------

		//Drivetrain

		if(vexRT[Btn5U] == 1)
		{
			r = -64;
		}
		else if(vexRT[Btn6U] == 1)
		{
			r = 64;
		}
		else
		{
			r = 0;
		}

		x = deadZone(vexRT[Ch4], 16);
		y = deadZone(vexRT[Ch3], 16);
		motor[frontLeft] = x + y + r;
		motor[backLeft] = -x + y + r;
		motor[frontRight] = x - y + r;
		motor[backRight] = -x - y + r;

		//----------------------
		// Partner Controller
		//----------------------

		//Pistons
		//0 = Up
		//1 = Down
		if(vexRT[Btn6UXmtr2] == 1)
		{
			//Raise the piston lift
			SensorValue[goalLiftPistons] = 0;
			SensorValue[goalLiftPistons] = 0;
		}
		else if(vexRT[Btn5UXmtr2] == 1)
		{
			//Lower the piston lift
			SensorValue[goalLiftPistons] = 1;
			SensorValue[goalLiftPistons] = 1;
		}
		else
		{
			//Don't do anything, leave the piston where it is
			EndTimeSlice();
		}

		// Claw
		// - = open claw
		// + = close claw
		motor[clawMotor] = -(deadZone(vexRT[Ch1Xmtr2], 16) / 2.0);

		//Lift
		// + = up
		// - = down
		motor[liftMotors] = deadZone(vexRT[Ch3Xmtr2], 16);

		//Turret
		// + = clockwise
		// - = counterclockwise
		motor[turretMotors] = deadZone(vexRT[Ch4Xmtr2], 16);
	}
}

// -----------------------------------------------------------------
